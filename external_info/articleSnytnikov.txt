                     Моделирование на суперЭВМ аномальной теплопроводности в плазме термоядерной ловушки. 
                                                       Снытников А.В.
                             Институт Вычислительной Математики и Математической Геофизики СО РАН, 
                                                    Россия, Новосибирск,
                                                    snytav@ssd.sscc.ru

Аннотация. 
Проводится моделирование взаимодействия плазмы с релятивистским электронным пучком в трехмерной постановке. 
Модель построена на основе метода частиц в ячейках. Типичные параметры расчета: сетка 128 узлов по каждому 
измерению, 50 частиц в ячейке, 20 часов счета с использованием 128 процессоров. Параллельная реализация 
выполнена с помощью метода декомпозиции области: используется смешанная эйлерово-лагранжева декомпозиция. 
Эффективность распараллеливания близка к 100 %, если число процессоров меньше 256. В результате расчетов
 на суперЭВМ удалось воспроизвести модуляцию плотности плазмы, которая является причиной аномального 
 понижения электронной теплопроводности в экспериментах. 
 Работа выполнена при поддержке Российского Фонда Фундаментальных Исследований, гранты 08-01-615 и 08-01-622, 
  а также интеграционных проектов СО РАН № 103, № 113 и № 26.
	
Часть I. Актуальность работы.
	Под аномальной теплопроводностью подразумевается наблюдаемое на многопробочной магнитной ловушке
ГОЛ-3 (ИЯФ СО РАН) понижение электронной теплопроводности на 2-3 порядка по сравнению с классическим значением. 
        Необходимость применения суперкомпьютерных вычислений обусловлена тем, что требуется, во-первых, 
иметь достаточно подробную сетку для того, чтобы воспроизвести резонансное взаимодействие релятивистского 
электронного пучка с плазмой, и, во-вторых, большое количество модельных частиц для того, чтобы промоделировать 
возникающую в дальнейшем турбулентность. 

Часть II. Моделирование температуры и теплопроводности.
	Определение теплопроводности по данным зависимостям от времени физических величин является сложной 
и нетривиальной задачей. Как правило, для нахождения интегральной (эффективной) частоты столкновений в случае
движения какой-либо группы частиц сквозь плазму (ионно-звуковая неустойчивость, неустойчивость Бунемана) 
используют закон сохранения импульса в системе частицы-волны. Находя изменение импульса волн, определяют 
изменение импульса частиц (как правило, электронов), обусловленное взаимодействием с волнами и эффективную 
частоту столкновений. При использовании метода расщепления функции распределения на медленно меняющуюся 
и быстроосциллирующую (которую относят к действию волн) эффективная частота столкновений определяется 
как некоторая интегральная величина, причем в подынтегральное выражение входит напряженность электрического 
поля волн. Этот метод правильно описывает качественную зависимость от энергии волн в спектре и макроскопических 
параметров плазмы, поведение получаемых таким образом транспортных коэффициентов совпадает с предсказаниями 
квазилинейной теории. 
	В то же время метод расщепления нельзя использовать, например, для оценки теплопроводности или 
предсказания зависимости длины пробега частицы от ее импульса; наконец, этот метод позволяет получить 
значение эффективной частоты столкновений выделенной группы частиц с волнами и частицами плазмы, но не 
позволяет исследовать микроскопические (кинетические) свойства плазмы. Также при выводе выражений для 
эффективной частоты столкновения приходится делать довольно много упрощающих предположений, таких, 
например, как опускание членов второго порядка при усреднении, описывающих нелинейное взаимодействие 
"волна-волна" и "волна-частица".
	По этой причине, чтобы избежать упрощений и получить качественно правильную картину аномальной 
теплопроводности, проводится моделирование на суперЭВМ. Наилучшим методом для численного моделирования 
неравновесной плазмы (то есть, при наличии каких-либо неустойчивостей) является метод частиц в ячейках. 
К его достоинствам также относится внутренний паралеллизм: траектории модельных частиц могут вычисляться 
независимо друг от друга, в том числе и на разных процессорах. В то же время, в методе частиц в ячейках 
существует проблема нефизических эффектов, так называемых шумов. Особенно это актуально при вычислении 
температуры, так как возникает необходимость определить, является ли разброс по скоростям модельных 
частиц физическим эффектом (температурой) или счетным (шумами). 
	Основной источник нефизических шумов в методе частиц-в-ячейках – наличие сетки, на которой вычисляются 
распределения плотности, скорости, тока. Поэтому при расчете температуры в методе частиц-в-ячейках возникает 
вопрос: насколько вычисляемая по частицам температура подвержена влиянию сетки? Как изменяются значения 
температуры при увеличении числа узлов сетки, при уменьшении пространственного шага? Были получены ответы 
на эти вопросы для случая электростатической плазмы. 
	Предложена методика для вычисления температуры по распределению модельных частиц в методе частиц 
в ячейках. Для одномерных расчетов показано, что энергия, находящаяся в коротколволновых гармониках сетки, 
уменьшается с увеличением числа узлов сетки. Также разогрев электронов в самосогласованном поле незачительно 
зависит от шага сетки. Эти выводы находятся в согласии с теретическими оценками.
	Для расчетов на трехмерной сетке было показано, что вычисляемая по частицам температура не зависит 
от числа модельных частиц. При выравнивании электронной и ионной температур скорость изменения температуры 
электронов зависит от шага сетки. Тем не менее, эта зависимость является сходящейся, и для достаточно большого 
количества узлов сетки фактически пропадает. Наконец, показано, что коротковолновые гармоники температуры и 
в трехмерном случае содержат лишь незначительную часть полной энергии спектра. Все сказанное позволяет 
утверждать, что для достаточно подробных сеток температура, определяемая по по распределению модельных 
частиц, не зависит от шага сетки. 

Часть III. Метод частиц для моделирования неравновесной плазмы.
	Плазма в экспериментах на ГОЛ-3 является существенно неравновесной, что делает невозможным применение 
численных методов гидродинамического типа для моделирования этой плазмы. Поэтому для решения задачи об 
аномальной теплопроводности используется метод частиц в ячейках.
	Метод частиц в ячейках получил широкое распространение для моделирования нестационарных задач
физики разреженной плазмы в настоящее время в связи с бурным развитием вычислительной техники, 
в том числе появлением многопроцессорных комплексов. Его распространению способствует и то, что он 
является фактически единственным методом для моделирования вышеупомянутых задач. Но при решении задач 
с большим числом частиц и в течение большого времени стали проявляться недостатки метода, которые 
раньше нельзя было заметить. Эти недостатки связаны с проявлением счетных шумов.
	В методе частиц каждая частица становится носителем некоторого набора характеристик среды, 
таких как заряд, масса, импульс, кинетическая энергия и т.д. Для того, чтобы аналогичным образом 
связать с каждой модельной частицой определенную температуру, необходимо сделать некоторое предположение
относительно вида функции распределения  в этой точке пространства (например, как это делается в методе SPH). 
Другой вариант — вычисление температуры по ансамблю частиц, но при этом возникает проблема отделения 
температуры от нефизических эффектов (шумов), возникающих в методе частиц.  Основной источник нефизических 
шумов в методе частиц-в-ячейках – наличие сетки, на которой вычисляются распределения плотности, скорости, тока.
	На сегодняшний день нет единого подхода к решению проблемы нефизических шумов, нет даже общепринятого  
количественного определения, что такое нефизический шум в методе частиц. Для уменьшения уровня нефизических 
шумов чаще всего либо увеличивают количество частиц, что не всегда  возможно в силу ограниченности ресурсов 
ЭВМ, либо модифицируют форму частицы. Трудность заключается в том, что при этом меняется и значение
 модельной температуры.

Часть IV. Параллельная реализация.
	Распараллеливание выполнено методом декомпозиции расчетной области по направлению, перпендикулярному 
направлению движения электронного пучка. Используется смешанная эйлерово-лагранжева декомпозиция. 
Сетка, на которой решаются уравнения Максвелла, разделена на одинаковые подобласти по одной из координат. 
С каждой подобластью связана группа процессоров (в том случае, когда вычисления производятся на многоядерных 
процессорах, процессором для единообразия будет именоваться отдельное ядро). Далее, модельные частицы каждой 
из подобластей разделяются между процессорами связанной с этой подобластью группы равномерно, вне зависимости 
от координаты. 
	Каждый из процессоров группы решает уравнения Максвелла во всей подобласти. Далее решются уравения 
движения модельных частиц. После этого происходит суммирование значений тока по всей подобласти. Один из 
процессоров группы производит обмен граничными значениями тока и полей с соседними подобластями, и затем 
рассылает полученные граничные значения всем процессорам своей группы. В случае, если и уравнения Максвелла 
для подобласти, и уравнения движения всех частиц подобласти частиц решаются на одном процессоре, вычисления 
с частицами занимают в 10-20 раз больше времени. 
	Вопрос об ускорении и эффективности распараллеливания в данном случае является вторичным. Основная 
цель создания параллельной программы для моделирования аномальной теплопроводности в плазме - возможность 
счета на больших сетках и с большим количеством модельных частиц. 
	Тем не менее можно сказать, что при относительно небольшом количестве процессорных ядер, используемых 
в расчете (до 256), ускорение близко к линейному, а эффективность - к 100 %. За основу для сравнения при этом 
берется модель, требующая большого времени вычислений, вопрос о том, насколько быстрее можно посчитать на 
суперкомпьютере задачу, которую можно посчитать и на настольной машине, в данной работе не рассматривается: 
такие задачи не представляют интереса с физической точки зрения.  
	Итак, ускорение вычислялось для задачи следующего размера: сетка 64 узла по всем трем измерениям, 
50 частиц в ячейке, 400 тыс. временных шагов, 5 суток счета на 16 процессорных ядрах (4-х ядерные процессоры Xeon). 
Это означает, что вычисляется ускорение для 32, 64, 128 и 256 ядер по сравнению с 16. В тот момент, когда число
используемых ядер становится больше, чем число узлов сетки по направлению, вдоль которого производится декомпозиция, 
дополнительные ядра используются для ускорения расчета с частицами. Это означает, что для указанной сетки расчетная 
область всегда делилась на 16 подобластей, а частицы каждой подобласти разделялись между  1,2,4,8 или 16 процессорами.
	Проводились вычисления на сетках следующего размера: 128, 256 узлов по каждому измерению. Число 
модельных частиц в каждой ячейке от 50 до 250. Для расчетов использовались суперкомпьютеры НКС-30Т 
(Новосибирск, ИВМиМГ СО РАН) - до 256 ядер в отдельном расчете, СКИФ Cyberia (Томск, ТГУ) - до 500 ядер 
в отдельном расчете, МВС-100000 (Москва, МСЦ), до 4096 ядер в отдельном расчете.
	Важно отметить, что использование суперкомпьютеров в данной задаче привело не просто к улучшению 
формальных показателей точности и скорости вычислений. Удалось добиться качественного улучшения понимания 
физической ситуации: благодаря расчету на суперкомпьютере НКС-30Т получена модуляция плотности электронов плазмы
под влиянием релаксации релятивистского электронного пучка. Предполагается, что именно расссеяние электронов
в областях повышенной плотности плазмы является причиной аномального понижения теплопроводности. А расчет 
на МВС-100000 позволил пронаблюдать в вычислительном эксперименте возникновение физической неустойчивости 
в плазме в результате резонансного взаимодействия с пучком.

Часть V. Аномальная теплопроводность в вычислительных экспериментах.

	Актуальность настоящей работы связана с тем, что в экспериментах на многопробочной магнитной ловушке 
ГОЛ-3 (ИЯФ СО РАН) наблюдается понижение электронной теплопроводности на 2-3 порядка по сравнению с классическим 
значением. Известно множество работ по моделированию теплопроводности в термоядерных установках. Вычисление 
температуры в этих работах производится в основном с помощью гидродинамических уравнений.  Таким образом функция 
распределения электронов по энергиям предполагается максвелловской, что может не соответствовать действительности. 
Для вычисления неравновесных  распределений применяют, в частности, бессеточные модификации метода частиц. 
Однако для метода частиц в ячейках не известны критерии, позволяющие понять, насколько правильным является 
полученное в расчетах распределение температуры, и таким образом, корректность моделирования теплопроводности 
также оказывается под вопросом.
	В вычислительных экспериментах обнаружен эффект понижения классической теплопроводности при инжекции 
в плазму мощного электронного пучка. При увеличении мощности пучка в рачетах наблюдалось уменьшение классической 
электронной теплопроводности, что соотвествует теории и данным экспериментов. Тем не менее, при различных 
параметрах плазмы и пучка, в зависимости от размера используемой сетки, классическая теплопроводность уменьшала 
на величину от 10 до 50 %, но не на 2-3 порядка, как в экспериментах. В самом деле, невозможно представить себе, 
чтобы в вычислениях с использованием метода частиц поток модельных частиц, переносящих энергию 
(то есть, собственно, теплопроводность) уменьшился бы на порядок или на два порядка. Это невозможно при сохранении 
числа модельных частиц, что, безусловно, выполняется.
	Предполагаемый физический механизм аномальной теплопроводности включает в себя: резонансное возбуждение 
колебаний плазмы при взаимодействии с релятивистским электронным пучком, возникновении модуляции плотности плазмы 
и последующее рассеяние электронов в областях с повышенной плотностью. Именно за счет рассеяния электронов, как 
предполагается, и возникает эффект понижения теплопроводности на порядки.
	В вычислительных экспериментах на суперЭВМ была получена модуляция плотности 
плазмы с амплитудой до 300 % (относительно начальной плотности плазмы). Исследована зависимость модуляции от 
начальной плотности плазмы, относительной плотности и энергии пучка, от массы ионов плазмы (водородная или 
дейтериевая плазма).
	Изучен процесс возбуждения колебаний плазмы в вычислительном эксперименте,
выяснено, какие именно волны возникают в плазме под влиянием пучка, от чего зависит их амплитуда. Показано, что 
при релаксации пучка большая доля его энергии переходит в плазменные волны, распространяющиеся перпендикулярно 
движению пучка. Поэтому необходимо обеспечить достаточно подробную сетку не только в продольном (вдоль движения пучка), 
но и в поперечном направлении, так как именно поперечные колебания являются причиной возникновения модуляции плазмы.
	Таким образом показано, что без использования суперЭВМ явление аномальной теплороводности в плазме 
изучено быть не может. Модуляции плотности были получены на сетке размером 128 узлов по каждому из трех измерений. 
При уменьшении числа узлов в поперечном направлении до 32 модуляции сохраняются, хотя изменяется набор 
возбуждаемых в плазме волн, при дальнейшем уменьшении числа узлов модуляции пропадают даже и при сохранении 
подробной сетки в продольном направлении.
	Также исследовано рассеяние электронов на сгустках плазмы (в областях с повышенной плотностью). 
Показано, что по мере релаксации пучка, и соответствующего возбуждения колебаний плазмы движение электронов 
становится более хаотическим. 

Заключение. 
В работе показано, что исследование теплопроводности в плазме может быть проведено с помощью метода частиц 
в ячейках. Описана параллельная реализация модели взаимодействия электронного пучка с плазмой, приведены 
показатели ускорения и эффективности. Указано, что наиболее важной явлется возможность исследования с помощью
суперЭВМ резонансного возбуждения плазменных колебаний в ходе релаксации пучка. Таким образом выяснилось, 
что именно использование суперЭВМ дает возможность численного моделирования аномальной теплопроводности в плазме.









